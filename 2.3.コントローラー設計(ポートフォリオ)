controllers/
├── admin/
|   ├── sessions_controller.rb [new, create, destroy]    ---A01
|   ├── homes_controller.rb [top]    ---A02
|   ├── offers_controller.rb [index, show, destroy, destroy_comment]    ---A03
|   ├── users_controller.rb [index, show, edit, update]    ---A04
├── concerns/
│   └── ...
├── application_controller.rb    ---01
└── public/
    ├── homes_controller.rb [top, about]    ---02
    ├── registrations_controller.rb [new, create]    ---03
    ├── sessions_controller.rb [new, create, destroy]    ---04
    ├── users_controller.rb [top, show, edit, update, quit, deactive, offers, applications, deals, favorites, followers, reviews]    ---05
    ├── relations_controller.rb [create, destroy]    ---06
    ├── locations_controller.rb [index, create, edit, update, destroy]    ---07
    ├── offers_controller.rb [new, create, show, edit, update, index]    ---08
    |── favorites_controller.rb [create, destroy]    ---09
    |── comments_controller.rb [create, destroy, edit, update]    ---10
    |── applications_controller.rb [new, create, thanx, show, destroy, edit, update, index]    ---11
    ├── deals_controller.rb [new, create, show, edit, update, index]    ---12
    ├── chattings_controller.rb [create, destroy]    ---13
    ├── reviews_controller.rb [new, create, show, edit, update]    ---14
    └── notificatons_controller.rb [index]    ---15

================================================================================================================================
01
class ApplicationController < ActionController::Base
    before_action :configure_authentication
    before_action :configure_permitted_parameters, if: :devise_controller?

protected

  def configure_authentication
    if admin_controller?
      authenticate_admin!
    else
      authenticate_user! unless public_controller?
    end
  end

  def admin_controller?
    self.class.module_parent_name == 'Admin'
  end

  def public_controller?
    self.class.module_parent_name == 'Public'
  end

  def configure_permitted_parameters
      devise_parameter_sanitizer.permit(:sign_up, keys: [:username, :last_name, :first_name, :introduction])
  end
end
================================================================================================================================
02
class Public::HomesController < ApplicationController
  def top
    @offers = Offer.where(offer_status: :true).order(created_at: :desc).limit(4)
    @locations = @offers.map(&:location)
  end

  def about
  end
end
================================================================================================================================
03
class Public::RegistrationsController < Devise::RegistrationsController
  before_action :configure_sign_up_params, only: [:create]

  def after_sign_up_path_for(resource)
    top_users_path
  end

  protected

  def configure_sign_up_params
    devise_parameter_sanitizer.permit(:sign_up, keys: [:username, :last_name, :first_name, :introduction])
  end
end
================================================================================================================================
04
class Public::SessionsController < Devise::SessionsController
  before_action :reject_user, only: [:create]

  def after_sign_in_path_for(resource)
    top_users_path
  end

  def after_sign_out_path_for(resource)
    root_path
  end

  def reject_user
    @user = User.find_by(email: params[:customer][:email])
    if @user
      if @user.valid_password?(params[:user][:password]) && !@customer.is_active
        flash[:notice] = "退会済みです。再度ご登録をしてご利用ください"
        redirect_to new_user_registration_path
      else
        flash[:notice] = "入力が正しくありません"
      end
    end
  end
end
================================================================================================================================
05



================================================================================================================================
06

================================================================================================================================
07



================================================================================================================================
A01
class Admin::SessionsController < Devise::SessionsController
  def after_sign_in_path_for(resource)
    flash[:notice] = "管理者ページにログインしました"
    admin_top_path
  end

  def after_sign_out_path_for(resource)
    flash[:notice] = "管理者ページにログアウトしました"
    new_admin_session_path
  end
end
================================================================================================================================
A02
class Admin::HomesController < ApplicationController
  def top
    @count_offer = Offer.offered_today.count
    @count_user = User.newuser_today.count
    @count_review = Offer.reviewed_today.count
    @total_offer = Offer.all.count
    @total_user = User.all.count
    @total_review = Review.all.count
  end
end
================================================================================================================================
A03
================================================================================================================================
A04
