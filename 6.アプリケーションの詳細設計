<HTTP method>
〇POSTの使用事例
ユーザーの登録
商品の注文
ブログ記事の投稿

〇PATCHの使用事例
ユーザーのプロフィールの更新（退会処理含む）
商品の価格の変更
ブログ記事の編集

〇PUTの使用事例
ユーザーのパスワードの変更
商品の在庫の更新
ブログ記事の公開

+++/config/routes.rb
Rails.application.routes.draw do
 
  root to: 'public/homes#top'
  get '/about' => 'public/homes#about'
  get '/admin' => 'admin/homes#top'

  scope module: :public do
    devise_for :customers, controllers: {sessions: 'public/customers/sessions', passwords: 'public/customers/passwords', registrations: 'public/customers/registrations'
    }

    resources :items, only: [:index, :show]
    resources :customers, only: [:show, :edit, :update] do
      member do
        get 'info'
        get 'quit'
        patch 'deactive'
      end
    end
    resources :deliveries, only: [:index, :create, :edit, :update, :destroy]
    resources :cart_items, only: [:index, :create, :update, :destroy] do
      collection do
        delete 'cart_items' => 'cart_items#destroy_all'
      end
    end
    resources :orders, only: [:new, :create, :index, :show] do
      collection do
        post 'confirm'
        get 'complete'
      end
    end
  end

  namespace :admin do
    devise_for :admin, controllers: {sessions: 'admin/sessions', passwords: 'admin/passwords', registrations: 'admin/registrations'
    }
    
    resources :items, only: [:index, :new, :create, :show, :edit, :update]
    resources :customers, only: [:index, :show, :edit, :update]
    resources :genres, only: [:index, :create, :edit, :update]
    resources :orders, only: [:show, :update] 
    resources :order_items, only: [:update] 
  end

end

=================================================================
1) ユーザーの退会処理 (PATCH)
class UsersController < ApplicationController
  def destroy
    @user = current_user
    @user.update(is_deleted: true)
    redirect_to users_path    #--- 退会確認画面へリダイレクト
  end
end

2) 販売ステータスの更新 (PATCH)
class ProductsController < ApplicationController
  def update_status
    @product = Product.find(params[:id])
    @product.update(sale_status: params[:sale_status])
    redirect_to product_path(@product)    #--- 販売ステータス更新完了画面へリダイレクト
  end
end

3) 注文ステータスの更新(PATCH)
class OrdersController < ApplicationController
  def update_status
    @order = Order.find(params[:id])
    @order.update(status: params[:status])
    redirect_to order_path(@order)    #--- 注文ステータス更新完了画面へリダイレクト
  end
end

4) ジャンル名称の変更(PUT)
class GenresController < ApplicationController
  def update
    genre = Genre.find(params[:id])    #--- ジャンルを取得
    genre.update(name: params[:name])    #--- ジャンルの名称を更新
    genre.products.each do |product|     #--- ジャンルに紐付く商品の名称を更新
      product.update(name: product.name.gsub(genre.name, params[:name]))
    end
    redirect_to genres_path    #--- ジャンル更新完了画面へリダイレクト
  end
  product.update(name: product.name.gsub(genre.name, params[:name]))
end

5) 注文のキャンセル時に、注文のキャンセル理由を記録する場合(PUT)
class OrdersController < ApplicationController
  def cancel
    order = Order.find(params[:id])        #--- 注文を取得
    order.update(status: "canceled", cancel_reason: params[:cancel_reason])        #--- 注文ステータスを「キャンセル済み」に更新
    redirect_to order_path(order)        #--- 注文キャンセル完了画面へリダイレクト
  end
end



